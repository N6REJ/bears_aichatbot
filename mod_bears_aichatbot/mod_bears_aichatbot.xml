<?xml version="1.0" encoding="utf-8"?>
<!--
    mod_bears_aichatbot - AI Knowledgebase Chatbot for Joomla 5
    Copyright (C) 2025 BearLeeAble (N6REJ)
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 2 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<extension type="module" version="5.0" client="site" method="upgrade">
    <name>Bears AI Chatbot</name>
    <author>N6REJ</author>
    <creationDate>2025 September 17</creationDate>
    <copyright>Copyright (C) 2025 Troy Hall (N6REJ)</copyright>
    <license>GNU General Public License version 3 or later; see License.txt</license>
    <version>2025.09.17</version>
    <description>MOD_BEARS_AICHATBOT_XML_DESCRIPTION</description>
    
    <install>
        <sql>
            <file driver="mysql" charset="utf8">sql/install.mysql.utf8.sql</file>
        </sql>
    </install>
    
    <uninstall>
        <sql>
            <file driver="mysql" charset="utf8">sql/uninstall.mysql.utf8.sql</file>
        </sql>
    </uninstall>
    
    <files>
        <filename module="mod_bears_aichatbot">mod_bears_aichatbot.php</filename>
        <filename>helper.php</filename>
        <filename>License.txt</filename>
        <folder>tmpl</folder>
        <folder>language</folder>
        <folder>media</folder>
        <folder>sql</folder>
        <folder>config</folder>
    </files>
    <languages>
        <language tag="en-GB">language/en-GB/en-GB.mod_bears_aichatbot.ini</language>
        <language tag="en-GB">language/en-GB/en-GB.mod_bears_aichatbot.sys.ini</language>
    </languages>
    <config>
        <fields name="params" addfieldpath="/modules/mod_bears_aichatbot/media/fields">
            <fieldset name="basic">
                <field name="use_kunena"
                       type="radio"
                       default="1"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_USE_KUNENA_LABEL"
                       description="MOD_BEARS_AICHATBOT_USE_KUNENA_DESC">
                            <option value="1">JYES</option>
                            <option value="0">JNO</option>
                </field>
                <field name="content_categories" type="category" extension="com_content" label="MOD_BEARS_AICHATBOT_CONTENT_CATEGORIES_LABEL" description="MOD_BEARS_AICHATBOT_CONTENT_CATEGORIES_DESC" multiple="true" />
                <field name="article_limit" type="number" default="1000" min="1" label="MOD_BEARS_AICHATBOT_ARTICLE_LIMIT_LABEL" description="MOD_BEARS_AICHATBOT_ARTICLE_LIMIT_DESC" />
                <field name="additional_urls" type="textarea" label="MOD_BEARS_AICHATBOT_ADDITIONAL_URLS_LABEL" description="MOD_BEARS_AICHATBOT_ADDITIONAL_URLS_DESC" rows="3" cols="50" filter="raw" />
                <field name="button_label" type="text" default="Knowledgebase" label="MOD_BEARS_AICHATBOT_BUTTON_LABEL_LABEL" description="MOD_BEARS_AICHATBOT_BUTTON_LABEL_DESC"/>
                <field name="intro_text" type="textarea" label="MOD_BEARS_AICHATBOT_INTRO_TEXT_LABEL" description="MOD_BEARS_AICHATBOT_INTRO_TEXT_DESC" rows="3" cols="50" default="Hello! I'm your AI assistant. Ask me anything about our knowledge base and I'll help you find the information you need." filter="raw" />
                <field name="no_data_message" type="textarea" label="MOD_BEARS_AICHATBOT_NO_DATA_MESSAGE_LABEL" description="MOD_BEARS_AICHATBOT_NO_DATA_MESSAGE_DESC" rows="2" cols="50" default="I'm sorry I don't know how to answer that" filter="raw" />
                <field name="include_sitemap"
                       type="radio"
                       default="0"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_INCLUDE_SITEMAP_LABEL"
                       description="MOD_BEARS_AICHATBOT_INCLUDE_SITEMAP_DESC">
                    <option value="1">JYES</option>
                    <option value="0">JNO</option>
                </field>
                    <field name="sitemap_url"
                       type="text" 
                       label="MOD_BEARS_AICHATBOT_SITEMAP_URL_LABEL" 
                       description="MOD_BEARS_AICHATBOT_SITEMAP_URL_DESC" 
                       hint="https://yoursite.com/sitemap?view=html&amp;id=1"
                       showon="include_sitemap:1"/>

                <field name="chat_position" type="list" default="bottom-right" label="MOD_BEARS_AICHATBOT_CHAT_POSITION_LABEL" description="MOD_BEARS_AICHATBOT_CHAT_POSITION_DESC">
                    <option value="bottom-right">MOD_BEARS_AICHATBOT_POSITION_BOTTOM_RIGHT</option>
                    <option value="bottom-left">MOD_BEARS_AICHATBOT_POSITION_BOTTOM_LEFT</option>
                    <option value="middle-right">Middle Right (side)</option>
                    <option value="middle-left">Middle Left (side)</option>
                </field>
                <field name="chat_offset_bottom" type="number" default="20" label="MOD_BEARS_AICHATBOT_OFFSET_BOTTOM_LABEL" description="MOD_BEARS_AICHATBOT_OFFSET_BOTTOM_DESC" min="0"/>
                <field name="chat_offset_side" type="number" default="20" label="MOD_BEARS_AICHATBOT_OFFSET_SIDE_LABEL" description="MOD_BEARS_AICHATBOT_OFFSET_SIDE_DESC" min="0"/>
                <field name="open_width" type="number" default="400" min="200" label="MOD_BEARS_AICHATBOT_OPEN_WIDTH_LABEL" description="MOD_BEARS_AICHATBOT_OPEN_WIDTH_DESC" />
                <field name="open_height" type="number" default="500" min="300" label="MOD_BEARS_AICHATBOT_OPEN_HEIGHT_LABEL" description="MOD_BEARS_AICHATBOT_OPEN_HEIGHT_DESC" />
                <field name="dark_mode"
                       type="radio" 
                       default="0" 
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_DARK_MODE_LABEL" 
                       description="MOD_BEARS_AICHATBOT_DARK_MODE_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="connection_check_interval"
                       type="number"
                       default="0"
                       min="0"
                       max="300"
                       step="10"
                       filter="integer"
                       label="MOD_BEARS_AICHATBOT_CONNECTION_CHECK_INTERVAL_LABEL"
                       description="MOD_BEARS_AICHATBOT_CONNECTION_CHECK_INTERVAL_DESC"
                       hint="0" />
            </fieldset>
            <fieldset name="accessibility" label="MOD_BEARS_AICHATBOT_FIELDSET_ACCESSIBILITY">
                <field name="text_to_speech"
                       type="radio"
                       default="0"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_TEXT_TO_SPEECH_LABEL"
                       description="MOD_BEARS_AICHATBOT_TEXT_TO_SPEECH_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="tts_rate"
                       type="number"
                       default="0.9"
                       min="0.1"
                       max="2.0"
                       step="0.1"
                       label="MOD_BEARS_AICHATBOT_TTS_RATE_LABEL"
                       description="MOD_BEARS_AICHATBOT_TTS_RATE_DESC"
                       showon="text_to_speech:1" />
                <field name="tts_pitch"
                       type="number"
                       default="1.0"
                       min="0.5"
                       max="2.0"
                       step="0.1"
                       label="MOD_BEARS_AICHATBOT_TTS_PITCH_LABEL"
                       description="MOD_BEARS_AICHATBOT_TTS_PITCH_DESC"
                       showon="text_to_speech:1" />
                <field name="tts_volume"
                       type="number"
                       default="0.8"
                       min="0.1"
                       max="1.0"
                       step="0.1"
                       label="MOD_BEARS_AICHATBOT_TTS_VOLUME_LABEL"
                       description="MOD_BEARS_AICHATBOT_TTS_VOLUME_DESC"
                       showon="text_to_speech:1" />
                <field name="spacer1" type="spacer" hr="true" />
                <field name="sound_notifications"
                       type="radio"
                       default="0"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_SOUND_NOTIFICATIONS_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_NOTIFICATIONS_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="sound_volume"
                       type="number"
                       default="0.1"
                       min="0.01"
                       max="1.0"
                       step="0.01"
                       label="MOD_BEARS_AICHATBOT_SOUND_VOLUME_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_VOLUME_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_sent_frequency"
                       type="number"
                       default="800"
                       min="200"
                       max="2000"
                       step="50"
                       label="MOD_BEARS_AICHATBOT_SOUND_SENT_FREQUENCY_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_SENT_FREQUENCY_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_sent_duration"
                       type="number"
                       default="100"
                       min="50"
                       max="500"
                       step="10"
                       label="MOD_BEARS_AICHATBOT_SOUND_SENT_DURATION_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_SENT_DURATION_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_received_frequency"
                       type="number"
                       default="600"
                       min="200"
                       max="2000"
                       step="50"
                       label="MOD_BEARS_AICHATBOT_SOUND_RECEIVED_FREQUENCY_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_RECEIVED_FREQUENCY_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_received_duration"
                       type="number"
                       default="150"
                       min="50"
                       max="500"
                       step="10"
                       label="MOD_BEARS_AICHATBOT_SOUND_RECEIVED_DURATION_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_RECEIVED_DURATION_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_error_frequency"
                       type="number"
                       default="300"
                       min="200"
                       max="2000"
                       step="50"
                       label="MOD_BEARS_AICHATBOT_SOUND_ERROR_FREQUENCY_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_ERROR_FREQUENCY_DESC"
                       showon="sound_notifications:1" />
                <field name="sound_error_duration"
                       type="number"
                       default="200"
                       min="50"
                       max="500"
                       step="10"
                       label="MOD_BEARS_AICHATBOT_SOUND_ERROR_DURATION_LABEL"
                       description="MOD_BEARS_AICHATBOT_SOUND_ERROR_DURATION_DESC"
                       showon="sound_notifications:1" />
                <field name="spacer2" type="spacer" hr="true" />
                <field name="aria_announcements"
                       type="radio"
                       default="1"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_ARIA_ANNOUNCEMENTS_LABEL"
                       description="MOD_BEARS_AICHATBOT_ARIA_ANNOUNCEMENTS_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="keyboard_shortcuts"
                       type="radio"
                       default="1"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_KEYBOARD_SHORTCUTS_LABEL"
                       description="MOD_BEARS_AICHATBOT_KEYBOARD_SHORTCUTS_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="focus_management"
                       type="radio"
                       default="1"
                       class="btn-group btn-group-yesno"
                       label="MOD_BEARS_AICHATBOT_FOCUS_MANAGEMENT_LABEL"
                       description="MOD_BEARS_AICHATBOT_FOCUS_MANAGEMENT_DESC">
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
            </fieldset>
            <fieldset name="configuration" label="MOD_BEARS_AICHATBOT_FIELDSET_CONFIGURATION">
                <field name="retrieval_top_k" type="number" default="6" min="1" max="20" label="MOD_BEARS_AICHATBOT_TOPK_LABEL" description="MOD_BEARS_AICHATBOT_TOPK_DESC" />
                <field name="retrieval_min_score" type="number" default="0.2" min="0" max="1" step="0.01" label="MOD_BEARS_AICHATBOT_MINSCORE_LABEL" description="MOD_BEARS_AICHATBOT_MINSCORE_DESC" />
                <field name="ionos_token_id" type="text" label="MOD_BEARS_AICHATBOT_TOKEN_ID_LABEL" description="MOD_BEARS_AICHATBOT_TOKEN_ID_DESC"/>
                <field name="ionos_token" type="textarea" label="MOD_BEARS_AICHATBOT_TOKEN_LABEL" description="MOD_BEARS_AICHATBOT_TOKEN_DESC" filter="raw" rows="4"/>
                <field name="ionos_endpoint" type="text" label="MOD_BEARS_AICHATBOT_ENDPOINT_LABEL" description="MOD_BEARS_AICHATBOT_ENDPOINT_DESC" default="https://openai.inference.de-txl.ionos.com/v1/chat/completions"/>
                <field name="ionos_model" type="ionosmodels" label="MOD_BEARS_AICHATBOT_MODEL_LABEL" description="MOD_BEARS_AICHATBOT_MODEL_DESC" default=""/>
            </fieldset>
            <fieldset name="limits" label="MOD_BEARS_AICHATBOT_FIELDSET_LIMITS">
                <field name="max_response_tokens" 
                       type="list" 
                       default="1024" 
                       label="MOD_BEARS_AICHATBOT_MAX_RESPONSE_TOKENS_LABEL" 
                       description="MOD_BEARS_AICHATBOT_MAX_RESPONSE_TOKENS_DESC">
                    <option value="256">256 tokens (Very short answers)</option>
                    <option value="512">512 tokens (Short answers)</option>
                    <option value="1024">1024 tokens (Normal answers)</option>
                    <option value="2048">2048 tokens (Detailed answers)</option>
                    <option value="4096">4096 tokens (Very detailed answers)</option>
                </field>
                <field name="max_context_length" 
                       type="number" 
                       default="30000" 
                       min="5000" 
                       max="100000" 
                       step="1000"
                       label="MOD_BEARS_AICHATBOT_MAX_CONTEXT_LENGTH_LABEL" 
                       description="MOD_BEARS_AICHATBOT_MAX_CONTEXT_LENGTH_DESC" />
                <field name="max_kunena_fetch" 
                       type="number" 
                       default="300"
                       min="10" 
                       max="1000"
                       step="10"
                       label="MOD_BEARS_AICHATBOT_MAX_KUNENA_FETCH_LABEL" 
                       description="MOD_BEARS_AICHATBOT_MAX_KUNENA_FETCH_DESC" />
                <field name="max_sitemap_urls" 
                       type="number" 
                       default="150" 
                       min="50" 
                       max="500" 
                       step="10"
                       label="MOD_BEARS_AICHATBOT_MAX_SITEMAP_URLS_LABEL" 
                       description="MOD_BEARS_AICHATBOT_MAX_SITEMAP_URLS_DESC" />
                <field name="request_timeout" 
                       type="number" 
                       default="30" 
                       min="10" 
                       max="120" 
                       step="5"
                       label="MOD_BEARS_AICHATBOT_REQUEST_TIMEOUT_LABEL" 
                       description="MOD_BEARS_AICHATBOT_REQUEST_TIMEOUT_DESC" />
                <field name="temperature" 
                       type="number" 
                       default="0.2" 
                       min="0" 
                       max="1" 
                       step="0.1"
                       label="MOD_BEARS_AICHATBOT_TEMPERATURE_LABEL" 
                       description="MOD_BEARS_AICHATBOT_TEMPERATURE_DESC" />
                <field name="chunk_size" 
                       type="list" 
                       default="8192" 
                       label="MOD_BEARS_AICHATBOT_CHUNK_SIZE_LABEL" 
                       description="MOD_BEARS_AICHATBOT_CHUNK_SIZE_DESC">
                    <option value="512">512 characters (~100 words)</option>
                    <option value="1024">1024 characters (~200 words)</option>
                    <option value="2048">2048 characters (~400 words)</option>
                    <option value="4096">4096 characters (~800 words)</option>
                    <option value="8192">8192 characters (~1600 words)</option>
                </field>
                <field name="chunk_overlap" 
                       type="number" 
                       default="200" 
                       min="50" 
                       max="500" 
                       step="50"
                       label="MOD_BEARS_AICHATBOT_CHUNK_OVERLAP_LABEL" 
                       description="MOD_BEARS_AICHATBOT_CHUNK_OVERLAP_DESC" />
            </fieldset>
            <fieldset name="keywords" label="MOD_BEARS_AICHATBOT_FIELDSET_KEYWORDS">
                <field name="keyword_min_length" type="number" default="3" min="1" max="10" label="MOD_BEARS_AICHATBOT_KEYWORD_MIN_LENGTH_LABEL" description="MOD_BEARS_AICHATBOT_KEYWORD_MIN_LENGTH_DESC" />
                <field name="keyword_max_length" type="number" default="50" min="10" max="100" label="MOD_BEARS_AICHATBOT_KEYWORD_MAX_LENGTH_LABEL" description="MOD_BEARS_AICHATBOT_KEYWORD_MAX_LENGTH_DESC" />
                <field name="ignore_words" type="ignorewords" label="MOD_BEARS_AICHATBOT_IGNORE_WORDS_LABEL" description="MOD_BEARS_AICHATBOT_IGNORE_WORDS_DESC" filter="raw" rows="8" cols="50" />
            </fieldset>
        </fields>
    </config>
    
    <updateservers>
        <server type="extension" priority="1" name="Bears AI Chatbot Updates">https://raw.githubusercontent.com/N6REJ/bears_aichatbot/main/updates.xml</server>
    </updateservers>
</extension>
